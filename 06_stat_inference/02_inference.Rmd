---
title: "Statistical Inference: Inferential Data Analysis"
output: pdf_document
author: https://github.com/johnsug/dss/blob/master/06_stat_inference/02_inference.Rmd
---

# Overview

In this paper, I will perform a basic statistical inferential data analysis on the **ToothGrowth** dataset from the R **datasets** package. The **ToothGrowth** data comes from a 1952 study measuring the effect of vitamin C on tooth growth on a population of 60 guinea pigs. The response is the length of the teeth after the guinea pigs were exposed to three different Vitamin C dose levels (0.5, 1.0, and 2.0 mg) with two delivery methods (orange juice [OJ] and ascorbic acid [VC]).

As part of this assignment, I will:
1. Perform some basic exploratory data analyses, 
2. Provide a basic summary of the data, 
3. Compare tooth growth by dose level and delivery method, using confidence intervals and hypothesis tests, and 
4. Reiterate my assumptions and state my conclusions

# Exploratory Data Analysis

The following faceted boxplots illustrate the distribution of tooth growth based on three dose levels from two delivery methods:

```{r eda, fig.height=2.5}
library(datasets)         ## contains 'ToothGrowth' dataset
library(ggplot2)          ## used for data viz
library(RColorBrewer)     ## loads ColorBrewer palettes

## data cleanup
dat <- ToothGrowth
dat$Dosage <- paste(dat$dose, "mg")

## plot bosplot
ggplot(dat, aes(x=supp, y=len, fill=Dosage)) + geom_boxplot() + facet_wrap(~Dosage) + 
  labs(title="Tooth Growth by Vitamin C Dosage and Delivery Method") + 
  labs(x="Delivery Method", y="Tooth Growth") + scale_fill_brewer(palette="RdYlBu") + 
  theme(legend.position="none")
```

The boxplots illustrate that the rate of tooth growth appears to be correlated with the amount of vitamin C administered. As well, it appears that delivery by orange juice [OJ] tends to produce more growth than does ascorbic acid [VC], especially in the lower dose amounts. Statistical inference tests will need to be conducted to determine whether there is a difference between delivery methods for 2 mg doses.

# Summary Statistics

Basic summary stats from the **ToothGrowth** dataset are as follows:

```{r summary stats}
names(dat) <- c("Tooth_Growth", "Delivery_Method", "Dose", "Dosage")
summary(dat[-4])  ## ignore the 'Dosage' tagging
```

*Note that there are **60** observations total; **10** for each delivery method/dosage combination.*

Lastly, the tooth growth measurements follow a somewhat-normal looking distribution:

```{r summary dist, fig.height=2.5, fig.width=4, fig.align="center"}
library(ggplot2)
ggplot(dat, aes(x=Tooth_Growth)) + geom_histogram(col="blue", fill="blue", binwidth=4, alpha=".3") + 
  labs(title="Distribution of Tooth Growth", x="Tooth Growth", y="Count")
```

The distribution would likely look more normal had a larger population of guinea pigs been used in the original research study.

# Statistical Inference

Although our box plot suggests that delivery by orange juice [OJ] tends to produce more growth than does ascorbic acid [VC] (especially in the lower dose amounts), we need to perform deeper analysis to argue whether this hypothesis is accurate. Two specific research questions I will investigate are:

1. Are the tooth growth rates for the two delivery methods significantly different **in the aggregate**?
2. Are the tooth growth rates for the two delivery methods significantly different **per dosage level**?

```{r t-tests, echo=FALSE}
tt <- t.test(Tooth_Growth ~ Delivery_Method, data=dat)
t_0.5 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="0.5 mg",])
t_1.0 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="1 mg",])
t_2.0 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="2 mg",])
```

To address the first question, we will look at the results from a Student's t-test, looking at the difference in growth rates based on the delivery method used by the scientists:

```{r aggregate t-test, eval=FALSE}
tt <- t.test(Tooth_Growth ~ Delivery_Method, data=dat)
```

Results from the t-test are as follows (see the appendix for the entire print-out from the t-test):

| difference in means | confidence interval |t-statistic | degrees of freedom | p-value |
|---------------------|---------------------|------------|--------------------|---------|
| `r round(tt$estimate[1]-tt$estimate[2],3)` | (`r round(tt$conf.int[1],3)`, `r round(tt$conf.int[2],3)`) | `r round(tt$statistic,3)` | `r round(tt$parameter,3)` | `r round(tt$p.value,4)` | 

With $\alpha$ = 0.05 and a p-value of **`r round(tt$p.value,4)`**, we must reject the null hypothesis, suggesting that the delivery methods is not statistically significant. As well, notice that the confidence interval contains zero, meaning that we are unsure if the difference in means between the two populations is in fact zero. That being said, we should drill down and look at the impact of the two delivery methods, based on the dosage of vitamin C delivered to the guinea pigs. 

```{r dosage t-tests, eval=FALSE}
t_0.5 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="0.5 mg",])
t_1.0 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="1 mg",])
t_2.0 <- t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="2 mg",])
```

The results from the t-tests above are summarized in the following table (again, see the appendix for the entire print-out from the t-tests):

| dosage | difference in means | confidence interval | t-statistic | degrees of freedom | p-value |
|--------|---------------------|---------------------|-------------|--------------------|---------|
| 0.5 mg | `r round(t_0.5$estimate[1]-t_0.5$estimate[2],3)` | (`r round(t_0.5$conf.int[1],3)`, `r round(t_0.5$conf.int[2],3)`) | `r round(t_0.5$statistic,3)` | `r round(t_0.5$parameter,3)` | `r round(t_0.5$p.value,4)` | 
| 1.0 mg | `r round(t_1.0$estimate[1]-t_1.0$estimate[2],3)` | (`r round(t_1.0$conf.int[1],3)`, `r round(t_1.0$conf.int[2],3)`) | `r round(t_1.0$statistic,3)` | `r round(t_1.0$parameter,3)` | `r round(t_1.0$p.value,4)` | 
| 2.0 mg | `r round(t_2.0$estimate[1]-t_2.0$estimate[2],3)` | (`r round(t_2.0$conf.int[1],3)`, `r round(t_2.0$conf.int[2],3)`) | `r round(t_2.0$statistic,3)` | `r round(t_2.0$parameter,3)` | `r round(t_2.0$p.value,4)` | 

These results tell a different story. The p-values from the 0.5 and 1.0 mg dose experiments, (**`r round(t_0.5$p.value,4)`** and
**`r round(t_1.0$p.value,4)`**, respectively) suggests that vitamin C delivered by orange juice leads to greater tooth growth than does absorbic acid.  However, the same cannot be said when 2.0 mg of vitamin C is delivered; with p = **`r round(t_2.0$p.value,4)`** and $\alpha$ = 0.05, we must reject the null hypothesis, suggesting that the delivery method is only significant for dosages under 2.0 mg.

# Assumptions and Conclusions

We only had 60 samples in our entire population, and 10 in each dosage/delivery method cohort. Due to a very low sample size, I used Student's t-tests instead of more robust z-tests. Had we a larger population, I'd expect different results from the statistical tests and for the distribution of all cohorts to look more normal.

This being said, it appears 1) that vitamin C consumption has a positive effect on guinea pig tooth growth rates, and 2) that orange juice produces greater tooth growth rates in guinea pigs than does absorbic acid when the population received 1.0 mg or less of vitamin C. When the guinea pigs received 2.0 mg of vitamin C, the guinea pigs had the largest rate of tooth growth, however it is indistinguishable whether orange juice is more efficient than absorbic acid at this dosage level.

\newpage

# Appendix

## Full print-outs from t-tests (see the **Statistical Inference** section of this report)

```{r appendix}
## aggregate growth box-plot -- notice the significant two boxes 
plot(Tooth_Growth ~ Delivery_Method, data=dat)
title("Guinea Pig Tooth Growth by Vitamin C Delivery Method Boxplots")

## aggregate delivery methods tooth growth t-test
t.test(Tooth_Growth ~ Delivery_Method, data=dat)

## dosage-level specific delivery methods tooth growth t-tests
# 0.5 mg
t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="0.5 mg",])

# 1.0 mg
t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="1 mg",])

# 2.0 mg
t.test(Tooth_Growth ~ Delivery_Method, data=dat[dat$Dosage=="2 mg",])
```
