---
title: "Regression Models Course Project"
author: "Rmd available at https://github.com/johnsug/dss/blob/master/07_regression/course_project.Rmd"
date: "September 26, 2015"
output: pdf_document
---

## Executive Summary

Using data from the 1974 *Motor Trend* US cars report, 32 automobiles (1973-1974 models) were analyzed in an attempt to quantify the following two research questions:

  1. Are automatic or manual transmissions are better for automobile mileage (MPG)?
  2. What is the MPG difference between automobiles with automatic and manual transmissions?

While the cars analyzed with manual transmissions did have higher MPGs than those with automatic transmissions, this correlation did not prove to infer causation. Using stepwise least-squares regression to minimize the Akaike information criterion (AIC), transmission type was **not** found to be a statistically significant determinant in miles per gallon (MPG) prediction. We fully acknowledge that this could be due in part to the small sample size used in the study (n=32). That being said, after holding significant features constant, this study suggests a **1.0 +/- 2.9 MPG differential** between manual and automatic transmissions. The 95% confience interval for this differential is (-1.9, 3.9), and the estimator has a p-value of 0.4825, again suggesting that the estimate is not statistically significant.


## 1. Introduction

Most automobiles run on gasoline (the exception being electric cars, biofuel-powered cars, and [time-traveling DeLorians](https://www.youtube.com/watch?v=3HYoq6vIVXc)). People often look to the Miles Per Gallon (MPG) measurement to understand how efficenet their automobiles are at propelling themselves based on the car's fuel consumption. Many believe that automobiles with manual transmissions have higher MPGs than those with automatic transmissions, but is there a real correlation between transmission type and MPG, or are other factors at play? We at *Motor Trent* wanted to investage this claim, and turned to our team of statisticians for answers. Specifically, we wanted to investigate the following two research questions:

1. Are automatic or manual transmissions are better for automobile mileage (MPG)?
2. What is the MPG difference between automobiles with automatic and manual transmissions?

Using data from the 1974 *Motor Trend* US cars report (see the [mtcars](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/mtcars.html) database in the R [datasets](https://stat.ethz.ch/R-manual/R-devel/library/datasets/html/00Index.html) package), 32 automobiles from 1973 and 1974 were analyzed in an attempt to quantify our research questions.

By strictly looking at summary statistics, the automobiles in our cohort with manual transmissions do have a higher average MPG than do the automatics (24.4 vs 17.1; see also the density plots in Figure 1 of the appendix), but now we need to understand if this is differntial is due to the transmission type, noise, or other factors.


## 2. Methods

Although density plots and summary statistics suggest that automobiles with manual or automatic transmission types exhube different MPG patterns, this correlation does not prove causation. In an attempt to hold constant all other features, we turned to least-squares regression to measure the effect of transmission type on MPG. Model selection was performed using stepwise selection methods, minimizing on the Akaike information criterion (AIC), followed by further diagnostic testing before reaching a final model in order to estimate transmission type's true effect on MPG.


## 3. Results

Upon first invoking the stepwise regression model selection function, we discovered that the variables that the most significant impact on predicting an automobile's MPG are as follows:

* Weight
* How long it takes the car to drive 1/4th of a mile
* Transmission type

Model parameters can be found in Table 1 of the appendix (note the adjusted R-squared of 0.8336). However, after looking at scatterplot interactions betwen these three variables and miles per gallon, there appeared to be a non-linear pattern between MPG and weight (see Figure 2 in the appendix). Therefore, we added a second-order term for weight to capture the marginal value and, after rerunning the stepwise regression, weight-squared was now statistically significant and miles per gallon was no longer significant in our best-fit regression model. 

However, by including the transmission type in the model, we were able to estimate that, holding weight, weight-squared, and 1/4th mile acceleration constant, we found that manual transmissions have a **1.0** higher MPG than do automatics. This new model has an adjusted R-squared of 0.8666, suggesting that is a better fit and more accurate estimation of the true impacting factors on MPG.  *(See Table 2 in the appendix for model parameters.)* However the 95th percentile confidence interval for this esitmation is (-1.9, 3.9) meaning that the true esimated differental is **1.0 +/- 2.9 MPG**, which isn't very precise nor accurate. (This is further confirmed by the estimate's p-value of 0.4825.) *(95th-percentile confidence intervals for all parameters in the final model can be found in Table 3 of the appendix.)#*

To further enhance the valadity of our research, we performed diagnostic and residual evaluations on our final proposed model. A QQ-Plot suggests that the linear model is most-likely normally distributed (Figure 3), with perhaps a few minor outliers, validating the use of least-squares regression. To investigate the residuals, Cook's D test and Influence plots were used to evaluate the potential outliers. *(For a joint visual, see Figure 4 in the appendix.)*  Ahtough these tests and visuals did sense a few potential outliers, ultimately all outliers were deemed as truly insignificant, due in part to their related low hat-values. Had the dataset been much larger, our reearchers may these diagnostics would have been more accurate to the true average values.


## Conclusion

We sought out to investigate whether cars with manual transmissions have higher MPGs than those with automatic transmissions. While it appers that they do, our data cannot prove that the source of the discrepancy is the transmission type. Rather, the most significant features in our study were the weight and time needed to travel one-fourth of a mile. However, we do acknowledge that our study may be biased 1) based on the low sample count (n=32) and 2) based on the dated dataset (1973-1974). We invite others to pick up where we left off.


\pagebreak

## Appendix

### Table 1: Initial Least-Squares Regression Parameters
```{r ols, echo=FALSE}
summary(lm(mpg ~ wt + qsec + am, data=mtcars))
```

### Table 2: Best-Fit Least-Squares Regression Parameters, Plus Transmission Type
```{r ols_2, echo=FALSE}
summary(lm(mpg ~ wt + I(wt*wt) + qsec + am, data=mtcars))
```

### Table 3: Confidence Interval for Transmission Type
```{r confidence interval, echo=FALSE}
confint(lm(mpg ~ wt + I(wt*wt) + qsec + am, data=mtcars))
```

### Figure 1: MPG by Transmission Type Density Plot, with Average Values
```{r, fig.height=3.5, echo=FALSE}
library(ggplot2)

dat <- mtcars
dat$transmission <- as.factor(cut(dat$am, c(-100,0,100), c("Automatic", "Manual")))
mean_manual <- mean(dat$mpg[dat$transmission=="Manual"])
mean_automatic <- mean(dat$mpg[dat$transmission=="Automatic"])

ggplot(dat, aes(x=mpg, fill=transmission)) + geom_density(alpha=.5) +
  theme(legend.position="bottom") + 
  geom_vline(x=mean_automatic, color="red", linetype="longdash") + geom_vline(x=mean_manual, color="blue", linetype="longdash")
```

### Figure 2: Simple Scatterplot Matrix
```{r scatterplot matrix, fig.height=3.5, echo=FALSE}
pairs(~mpg + wt + qsec, data=mtcars)
```

### Figure 3: QQ-Plot
```{r qqplot, fig.height=4, echo=FALSE, warning=FALSE}
library(car)

final_model <- lm(mpg ~ wt + I(wt*wt) + qsec + am, data=mtcars)
qqPlot(final_model)
```

### Figure 4: Cook's D Plot and Influence Plot
```{r combo, fig.height=3.5, echo=FALSE, warning=FALSE}
library(car)

final_model <- lm(mpg ~ wt + I(wt*wt) + qsec + am, data=mtcars)
cutoff_final <- 4/((nrow(mtcars)-length(final_model$coefficients)-2)) 

par(mfrow=c(1,2))
plot(final_model, which=4, cook.levels=cutoff)
influencePlot(final_model, id.method="identify", sub="Circle size is proportial to Cook's Distance" )
par(mfrow=c(1,1))
```

